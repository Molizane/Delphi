000001 0000                  ;****************************************
000002 0000                  ;	   PROGRAMA MONITOR NESTOR
000003 0000                  ;	       NOVA ELETRÔNICA
000004 0000                  ;	SAO PAULO S.P. 01/84 MSCS/JRP
000005 0000                  ;****************************************
000006 0000                  
000007 0003                  	.equ	PDIG, 	h'03 ; saída coluna teclado e display
000008 0001                  	.equ	PSEG, 	h'01 ; saída caracter para o display
000009 0001                  	.equ	PTEC, 	h'01 ; entrada linha teclado
000010 0000                  
000011 0001                  	.equ	ATRASO, 	h'0001
000012 0BE4                  	.equ	TOPSP, 	h'0be4
000013 0BE5                  	.equ	MENCON, 	h'0be5
000014 0BE6                  	.equ	FLAG, 	h'0be6
000015 0BE7                  	.equ	BUFDISP, 	h'0be7
000016 0BEB                  	.equ	BYTES, 	h'0beb
000017 0BED                  	.equ	ENDISP, 	h'0bed
000018 0BEE                  	.equ	PBE, 	h'0bee
000019 0BEF                  	.equ	PAE, 	h'0bef
000020 0BF0                  	.equ	ROT, 	h'0bf0
000021 0BF2                  	.equ	ROTNMI, 	h'0bf2
000022 0BF7                  	.equ	MENI, 	h'0bf7
000023 0BF8                  	.equ	MENF, 	h'0bf8
000024 0BF9                  	.equ	MENA, 	h'0bf9
000025 0BFA                  	.equ	MENL, 	h'0bfa
000026 0BFB                  	.equ	MENH, 	h'0bfb
000027 0BFC                  	.equ	MENE, 	h'0bfc
000028 0BFD                  	.equ	MEND, 	h'0bfd
000029 0BFE                  	.equ	MENC, 	h'0bfe
000030 0BFF                  	.equ	MENB, 	h'0bff
000031 0000                  
000032 0000                  		.org	h'0000
000033 0000 31000C           		ld	sp, h'0c00
000034 0003 C5               		push	bc
000035 0004 D5               		push	de
000036 0005 E5               		push	hl
000037 0006 F5               		push	af
000038 0007 21E60B           		ld	hl, FLAG
000039 000A 3619             		ld	(hl), h'19
000040 000C 215C00           		ld	hl, MENS
000041 000F 11E70B           		ld	de, BUFDISP
000042 0012 010600           		ld	bc, h'0006
000043 0015 EDB0             		ldir
000044 0017 31E40B           INICIO:	ld	sp, TOPSP
000045 001A 21E70B           		ld	hl, BUFDISP
000046 001D 0600             		ld	b, h'00
000047 001F 1E06             		ld	e, h'06
000048 0021 3E01             		ld	a, h'01
000049 0023 CD9000           NE1:	call	VARR
000050 0026 79               		ld	a, c
000051 0027 87               		add	a, a
000052 0028 1D               		dec	e
000053 0029 C22300           		jp	nz, NE1
000054 002C 78               		ld	a, b
000055 002D FE00             		cp	h'00
000056 002F CA1700           		jp	z, INICIO
000057 0032 21E70B           NE2:	ld	hl, BUFDISP
000058 0035 CD9C00           		call	REST
000059 0038 7A               		ld	a, d
000060 0039 D303             		out	(PDIG), a
000061 003B DB01             		in	a, (PTEC)
000062 003D FE00             		cp	h'00
000063 003F C23200           		jp	nz, NE2
000064 0042 CDBD00           		call	AJCOL
000065 0045 CDD800           		call	AJTEC
000066 0048 FE13             		cp	h'13
000067 004A CA7700           		jp	z, NE3
000068 004D FE10             		cp	h'10
000069 004F DA8300           		jp	c, NE4
000070 0052 CDF000           NE5:	call	ALTCOM
000071 0055 21E60B           NE6:	ld	hl, FLAG
000072 0058 7E               		ld	a, (hl)
000073 0059 C36900           		jp	RECCOM
000074 005C                  ;
000075 005C C8               MENS:	.db	h'c8; N
000076 005D 86               		.db	h'86; E
000077 005E 92               		.db	h'92; S
000078 005F 87               		.db	h'87; T
000079 0060 C0               		.db	h'c0; O
000080 0061 CE               		.db	h'ce; R
000081 0062 00               		.db	h'00
000082 0063 00               		.db	h'00
000083 0064 00               		.db	h'00
000084 0065 00               		.db	h'00
000085 0066                  
000086 0066                  ;****************************************
000087 0066                  ;  ponto de entrada de interrupção nmi
000088 0066                  ;****************************************
000089 0066                  
000090 0066 C3F20B           NMINT:	jp	ROTNMI	; antes estava "RIV"
000091 0069                  ;
000092 0069 212003           RECCOM:	ld	hl, TABCOM+1
000093 006C 85               		add	a, l
000094 006D 6F               		ld	l, a
000095 006E 7E               		ld	a, (hl)
000096 006F 4F               		ld	c, a
000097 0070 3E0A             		ld	a, h'0a
000098 0072 85               		add	a, l
000099 0073 6F               		ld	l, a
000100 0074 6E               		ld	l, (hl)
000101 0075 61               		ld	h, c
000102 0076 E9               		jp	(hl)
000103 0077 21E60B           NE3:	ld	hl, FLAG
000104 007A 7E               		ld	a, (hl)
000105 007B FE15             		cp	h'15
000106 007D CAF401           		jp	z, SELREG
000107 0080 C35200           		jp	NE5
000108 0083 21E60B           NE4:	ld	hl, FLAG
000109 0086 7E               		ld	a, (hl)
000110 0087 FE15             		cp	h'15
000111 0089 CA0502           		jp	z, ALTREG
000112 008C 00               		nop
000113 008D C35500           		jp	NE6
000114 0090                  
000115 0090                  ;****************************************
000116 0090                  ;	rotina de varredura
000117 0090                  ;****************************************
000118 0090                  
000119 0090 4F               VARR:	ld	c, a
000120 0091 CDA900           		call	TEMPO
000121 0094 DB01             		in	a, (PTEC)
000122 0096 FE00             		cp	h'00
000123 0098 C8               		ret	z
000124 0099 47               		ld	b, a
000125 009A 51               		ld	d, c
000126 009B C9               		ret
000127 009C                  
000128 009C                  ;****************************************
000129 009C                  ;	rotina de restauração
000130 009C                  ;****************************************
000131 009C                  
000132 009C 0E06             REST:	ld	c, h'06
000133 009E 3E01             		ld	a, h'01
000134 00A0 CDA900           NE7:	call	TEMPO
000135 00A3 87               		add	a, a
000136 00A4 0D               		dec	c
000137 00A5 C8               		ret	z
000138 00A6 C3A000           		jp	NE7
000139 00A9                  
000140 00A9                  ;****************************************
000141 00A9                  ;	rotina de tempo
000142 00A9                  ;****************************************
000143 00A9                  
000144 00A9 F5               TEMPO:	push	af
000145 00AA D303             		out	(PDIG), a
000146 00AC 7E               		ld	a, (hl)
000147 00AD D301             		out	(PSEG), a
000148 00AF D9               		exx
000149 00B0 110100           		ld	de, ATRASO
000150 00B3 1B               LOOP1:	dec	de
000151 00B4 7A               		ld	a, d
000152 00B5 B3               		or	e
000153 00B6 C2B300           		jp	nz, LOOP1
000154 00B9 D9               		exx
000155 00BA 23               		inc	hl
000156 00BB F1               		pop	af
000157 00BC C9               		ret
000158 00BD                  
000159 00BD                  ;****************************************
000160 00BD                  ;	rotina de ajuste de coluna
000161 00BD                  ;****************************************
000162 00BD                  
000163 00BD 0E00             AJCOL:	ld	c, h'00
000164 00BF 3E01             		ld	a, h'01
000165 00C1 BA               		cp	d
000166 00C2 CAD600           		jp	z, NE8
000167 00C5 87               		add	a, a
000168 00C6 0E08             		ld	c, h'08
000169 00C8 BA               		cp	d
000170 00C9 CAD600           		jp	z, NE8
000171 00CC 87               		add	a, a
000172 00CD 0E10             		ld	c, h'10
000173 00CF BA               		cp	d
000174 00D0 CAD600           		jp	z, NE8
000175 00D3 C31700           		jp	INICIO
000176 00D6 51               NE8:	ld	d, c
000177 00D7 C9               		ret
000178 00D8                  
000179 00D8                  ;****************************************
000180 00D8                  ;	rotina de ajuste de tecla
000181 00D8                  ;****************************************
000182 00D8                  
000183 00D8 1E08             AJTEC:	ld	e, h'08
000184 00DA 0E00             		ld	c, h'00
000185 00DC 3E01             		ld	a, h'01
000186 00DE B8               NE10:	cp	b
000187 00DF CAEB00           		jp	z, NE9
000188 00E2 0C               		inc	c
000189 00E3 87               		add	a, a
000190 00E4 1D               		dec	e
000191 00E5 C2DE00           		jp	nz, NE10
000192 00E8 C31700           		jp	INICIO
000193 00EB 79               NE9:	ld	a, c
000194 00EC 82               		add	a, d
000195 00ED 47               		ld	b, a
000196 00EE 00               		nop
000197 00EF C9               		ret
000198 00F0                  
000199 00F0                  ;****************************************
000200 00F0                  ;	rotina de alterar comando
000201 00F0                  ;****************************************
000202 00F0                  
000203 00F0 21E60B           ALTCOM:	ld	hl, FLAG
000204 00F3 70               		ld	(hl), b
000205 00F4 C9               		ret
000206 00F5                  
000207 00F5                  ;****************************************
000208 00F5                  ;	rotina de permissão
000209 00F5                  ;****************************************
000210 00F5                  
000211 00F5 0E06             ROTPER:	ld	c, h'06
000212 00F7 21E60B           		ld	hl, FLAG
000213 00FA 3617             		ld	(hl), h'17
000214 00FC 23               		inc	hl
000215 00FD 36FF             NE11:	ld	(hl), h'ff
000216 00FF 23               		inc	hl
000217 0100 0D               		dec	c
000218 0101 C2FD00           		jp	nz, NE11
000219 0104 3600             		ld	(hl), h'00
000220 0106 23               		inc	hl
000221 0107 3600             		ld	(hl), h'00
000222 0109 23               		inc	hl
000223 010A 3600             		ld	(hl), h'00
000224 010C C31700           		jp	INICIO
000225 010F                  
000226 010F                  ;****************************************
000227 010F                  ;	rotina de campo de endereços
000228 010F                  ;****************************************
000229 010F                  
000230 010F 21EE0B           ROTCP:	ld	hl, PBE
000231 0112 78               		ld	a, b
000232 0113 ED6F             		rld
000233 0115 23               		inc	hl
000234 0116 ED6F             		rld
000235 0118 CD5201           		call	DECOD
000236 011B C31700           		jp	INICIO
000237 011E                  
000238 011E                  ;****************************************
000239 011E                  ;	rotina de leitura
000240 011E                  ;****************************************
000241 011E                  
000242 011E CD4001           ROTLT:	call	ATUAL
000243 0121 21E60B           		ld	hl, FLAG
000244 0124 3618             		ld	(hl), h'18
000245 0126 21EF0B           		ld	hl, PAE
000246 0129 CD5201           		call	DECOD
000247 012C C31700           		jp	INICIO
000248 012F                  
000249 012F                  ;****************************************
000250 012F                  ;	rotina de campo de dados
000251 012F                  ;****************************************
000252 012F                  
000253 012F CD4001           ROTCD:	call	ATUAL
000254 0132 78               		ld	a, b
000255 0133 ED6F             		rld
000256 0135 7E               		ld	a, (hl)
000257 0136 12               		ld	(de), a
000258 0137 21EF0B           		ld	hl, PAE
000259 013A CD5201           		call	DECOD
000260 013D C31700           		jp	INICIO
000261 0140                  
000262 0140                  ;****************************************
000263 0140                  ;	rotina de atualização
000264 0140                  ;****************************************
000265 0140                  
000266 0140 21EE0B           ATUAL:	ld	hl, PBE
000267 0143 5E               		ld	e, (hl)
000268 0144 23               		inc	hl
000269 0145 56               		ld	d, (hl)
000270 0146 1A               		ld	a, (de)
000271 0147 2B               		dec	hl
000272 0148 2B               		dec	hl
000273 0149 77               		ld	(hl), a
000274 014A E5               		push	hl
000275 014B 21E60B           		ld	hl, FLAG
000276 014E 3618             		ld	(hl), h'18
000277 0150 E1               		pop	hl
000278 0151 C9               		ret
000279 0152                  
000280 0152                  ;****************************************
000281 0152                  ;	rotina de DECODificação
000282 0152                  ;****************************************
000283 0152                  
000284 0152 01E70B           DECOD:	ld	bc, BUFDISP
000285 0155 CD6E01           		call	DISPLY
000286 0158 2B               		dec	hl
000287 0159 CD6E01           		call	DISPLY
000288 015C 2B               		dec	hl
000289 015D CD6E01           		call	DISPLY
000290 0160 C9               		ret
000291 0161                  
000292 0161                  ;****************************************
000293 0161                  ;  rotina de ajuste memória de endereço
000294 0161                  ;****************************************
000295 0161                  
000296 0161 21EE0B           RAME:	ld	hl, PBE
000297 0164 73               		ld	(hl), e
000298 0165 23               		inc	hl
000299 0166 72               		ld	(hl), d
000300 0167 2B               		dec	hl
000301 0168 2B               		dec	hl
000302 0169 1A               		ld	a, (de)
000303 016A 77               		ld	(hl), a
000304 016B C9               		ret
000305 016C FFFF             		.dw	h'ffff
000306 016E                  
000307 016E                  ;****************************************
000308 016E                  ;	rotina de DISPLY
000309 016E                  ;****************************************
000310 016E                  
000311 016E 7E               DISPLY:	ld	a, (hl)
000312 016F E5               		push	hl
000313 0170 21F00B           		ld	hl, ROT
000314 0173 77               		ld	(hl), a
000315 0174 AF               		xor	a
000316 0175 ED6F             		rld
000317 0177 CD8601           		call	FORMAT
000318 017A 02               		ld	(bc), a
000319 017B 03               		inc	bc
000320 017C AF               		xor	a
000321 017D ED6F             		rld
000322 017F CD8601           		call	FORMAT
000323 0182 02               		ld	(bc), a
000324 0183 03               		inc	bc
000325 0184 E1               		pop	hl
000326 0185 C9               		ret
000327 0186                  
000328 0186                  ;****************************************
000329 0186                  ;	rotina de formatação
000330 0186                  ;****************************************
000331 0186                  
000332 0186 D5               FORMAT:	push	de
000333 0187 118F01           		ld	de, INTD
000334 018A 83               		add	a, e
000335 018B 5F               		ld	e, a
000336 018C 1A               		ld	a, (de)
000337 018D D1               		pop	de
000338 018E C9               		ret
000339 018F                  
000340 018F                  ;****************************************
000341 018F                  ;	tabela de formatos alfa (números)
000342 018F                  ;****************************************
000343 018F                  
000344 018F C0               INTD:	.db	h'c0
000345 0190 F9               		.db	h'f9
000346 0191 A4               		.db	h'a4
000347 0192 B0               		.db	h'b0
000348 0193 99               		.db	h'99
000349 0194 92               		.db	h'92
000350 0195 82               		.db	h'82
000351 0196 F8               		.db	h'f8
000352 0197 80               		.db	h'80
000353 0198 90               		.db	h'90
000354 0199 88               		.db	h'88
000355 019A 83               		.db	h'83
000356 019B C6               		.db	h'c6
000357 019C A1               		.db	h'a1
000358 019D 86               		.db	h'86
000359 019E 8E               		.db	h'8e
000360 019F                  
000361 019F                  ;****************************************
000362 019F                  ;	rotina de próximo
000363 019F                  ;****************************************
000364 019F                  
000365 019F CD4001           ROTPR:	call	ATUAL
000366 01A2 13               		inc	de
000367 01A3 CD6101           		call	RAME
000368 01A6 21EF0B           		ld	hl, PAE
000369 01A9 CD5201           		call	DECOD
000370 01AC C31700           		jp	INICIO
000371 01AF                  
000372 01AF                  ;****************************************
000373 01AF                  ;	rotina de último
000374 01AF                  ;****************************************
000375 01AF                  
000376 01AF CD4001           ROTUL:	call	ATUAL
000377 01B2 1B               		dec	de
000378 01B3 CD6101           		call	RAME
000379 01B6 21EF0B           		ld	hl, PAE
000380 01B9 CD5201           		call	DECOD
000381 01BC C31700           		jp	INICIO
000382 01BF                  
000383 01BF                  ;****************************************
000384 01BF                  ;	rotina de rodar
000385 01BF                  ;****************************************
000386 01BF                  
000387 01C8                  		.org	h'01c8
000388 01C8 3EFF             ROTRD:	ld	a, h'ff
000389 01CA D303             		out	(PDIG), a
000390 01CC 3E7F             		ld	a, h'7f
000391 01CE D301             		out	(PSEG), a
000392 01D0 21ED0B           		ld	hl, ENDISP; antes estava "MEND"
000393 01D3 36C3             		ld	(hl), h'c3; h'c3 = "jp"
000394 01D5 31F80B           		ld	sp, MENF	; antes estava "MENI"
000395 01D8 F5               		push	af
000396 01D9 E5               		push	hl
000397 01DA D5               		push	de
000398 01DB C5               		push	bc
000399 01DC 31E40B           		ld	sp, TOPSP
000400 01DF C3ED0B           		jp	ENDISP
000401 01E2                  
000402 01E2                  ;****************************************
000403 01E2                  ;    rotina de exame de registradores
000404 01E2                  ;****************************************
000405 01E2                  
000406 01E2 21E50B           ROTER:	ld	hl, MENCON
000407 01E5 36FE             		ld	(hl), h'fe
000408 01E7 C3F401           		jp	SELREG
000409 01EA                  
000410 01EA                  ;****************************************
000411 01EA                  ;	rotina de inicialização
000412 01EA                  ;****************************************
000413 01EA                  
000414 01EA 21E70B           INIT:	ld	hl, BUFDISP
000415 01ED 36FF             		ld	(hl), h'ff
000416 01EF 23               		inc	hl
000417 01F0 36FF             		ld	(hl), h'ff
000418 01F2 23               		inc	hl
000419 01F3 C9               		ret
000420 01F4                  
000421 01F4                  ;****************************************
000422 01F4                  ;   rotina de seleção de registradores
000423 01F4                  ;****************************************
000424 01F4                  
000425 01F4 110403           SELREG:	ld	de, TABREG
000426 01F7 21E50B           		ld	hl, MENCON
000427 01FA 34               		inc	(hl)
000428 01FB 34               		inc	(hl)
000429 01FC 7B               		ld	a, e
000430 01FD 86               		add	a, (hl)
000431 01FE 5F               NE12:	ld	e, a
000432 01FF 1A               		ld	a, (de)
000433 0200 6F               		ld	l, a
000434 0201 13               		inc	de
000435 0202 1A               		ld	a, (de)
000436 0203 67               		ld	h, a
000437 0204 E9               		jp	(hl)
000438 0205                  
000439 0205                  ;****************************************
000440 0205                  ;  rotina de alteração de registradores
000441 0205                  ;****************************************
000442 0205                  
000443 0205 21E50B           ALTREG:	ld	hl, MENCON
000444 0208 111B03           		ld	de, TABALT
000445 020B 7B               		ld	a, e
000446 020C 86               		add	a, (hl)
000447 020D C3FE01           		jp	NE12
000448 0210                  
000449 0210                  ;****************************************
000450 0210                  ;	registrador a
000451 0210                  ;****************************************
000452 0210                  
000453 0210 CDEA01           REGA:	call	INIT
000454 0213 3688             		ld	(hl), h'88
000455 0215 23               		inc	hl
000456 0216 36B7             		ld	(hl), h'b7
000457 0218 21F90B           		ld	hl, MENA
000458 021B C31E02           		jp	ROTSA
000459 021E                  
000460 021E                  ;****************************************
000461 021E                  ;	rotina de saída
000462 021E                  ;****************************************
000463 021E                  
000464 021E 01EB0B           ROTSA:	ld	bc, BYTES
000465 0221 CD6E01           		call	DISPLY
000466 0224 C31700           		jp	INICIO
000467 0227                  
000468 0227                  ;****************************************
000469 0227                  ;	altera registrador a
000470 0227                  ;****************************************
000471 0227                  
000472 0227 21F90B           ALTA:	ld	hl, MENA
000473 022A 78               		ld	a, b
000474 022B ED6F             		rld
000475 022D C31E02           		jp	ROTSA
000476 0230                  
000477 0230                  ;****************************************
000478 0230                  ;	registrador b
000479 0230                  ;****************************************
000480 0230                  
000481 0230 CDEA01           REGB:	call	INIT
000482 0233 3683             		ld	(hl), h'83
000483 0235 23               		inc	hl
000484 0236 36B7             		ld	(hl), h'b7
000485 0238 21FF0B           		ld	hl, MENB
000486 023B C31E02           		jp	ROTSA
000487 023E                  
000488 023E                  ;****************************************
000489 023E                  ;	altera registrador b
000490 023E                  ;****************************************
000491 023E                  
000492 023E 21FF0B           ALTB:	ld	hl, MENB
000493 0241 78               		ld	a, b
000494 0242 ED6F             		rld
000495 0244 C31E02           		jp	ROTSA
000496 0247                  
000497 0247                  ;****************************************
000498 0247                  ;	registrador c
000499 0247                  ;****************************************
000500 0247                  
000501 0247 CDEA01           REGC:	call	INIT
000502 024A 36C6             		ld	(hl), h'c6
000503 024C 23               		inc	hl
000504 024D 36B7             		ld	(hl), h'b7
000505 024F 21FE0B           		ld	hl, MENC
000506 0252 C31E02           		jp	ROTSA
000507 0255                  
000508 0255                  ;****************************************
000509 0255                  ;	altera registrador c
000510 0255                  ;****************************************
000511 0255                  
000512 0255 21FE0B           ALTC:	ld	hl, MENC
000513 0258 78               		ld	a, b
000514 0259 ED6F             		rld
000515 025B C31E02           		jp	ROTSA
000516 025E                  
000517 025E                  ;****************************************
000518 025E                  ;	registrador d
000519 025E                  ;****************************************
000520 025E                  
000521 025E CDEA01           REGD:	call	INIT
000522 0261 36A1             		ld	(hl), h'a1
000523 0263 23               		inc	hl
000524 0264 36B7             		ld	(hl), h'b7
000525 0266 21FD0B           		ld	hl, MEND
000526 0269 C31E02           		jp	ROTSA
000527 026C                  
000528 026C                  ;****************************************
000529 026C                  ;	altera registrador d
000530 026C                  ;****************************************
000531 026C                  
000532 026C 21FD0B           ALTD:	ld	hl, MEND
000533 026F 78               		ld	a, b
000534 0270 ED6F             		rld
000535 0272 C31E02           		jp	ROTSA
000536 0275                  
000537 0275                  ;****************************************
000538 0275                  ;	registrador e
000539 0275                  ;****************************************
000540 0275                  
000541 0275 CDEA01           REGE:	call	INIT
000542 0278 3686             		ld	(hl), h'86
000543 027A 23               		inc	hl
000544 027B 36B7             		ld	(hl), h'b7
000545 027D 21FC0B           		ld	hl, MENE
000546 0280 C31E02           		jp	ROTSA
000547 0283                  
000548 0283                  ;****************************************
000549 0283                  ;	altera registrador e
000550 0283                  ;****************************************
000551 0283                  
000552 0283 21FC0B           ALTE:	ld	hl, MENE
000553 0286 78               		ld	a, b
000554 0287 ED6F             		rld
000555 0289 C31E02           		jp	ROTSA
000556 028C                  
000557 028C                  ;****************************************
000558 028C                  ;	registrador h
000559 028C                  ;****************************************
000560 028C                  
000561 028C CDEA01           REGH:	call	INIT
000562 028F 3689             		ld	(hl), h'89
000563 0291 23               		inc	hl
000564 0292 36B7             		ld	(hl), h'b7
000565 0294 21FB0B           		ld	hl, MENH
000566 0297 C31E02           		jp	ROTSA
000567 029A                  
000568 029A                  ;****************************************
000569 029A                  ;	altera registrador h
000570 029A                  ;****************************************
000571 029A                  
000572 029A 21FB0B           ALTH:	ld	hl, MENH
000573 029D 78               		ld	a, b
000574 029E ED6F             		rld
000575 02A0 C31E02           		jp	ROTSA
000576 02A3                  
000577 02A3                  ;****************************************
000578 02A3                  ;	registrador l
000579 02A3                  ;****************************************
000580 02A3                  
000581 02A3 CDEA01           REGL:	call	INIT
000582 02A6 36C7             		ld	(hl), h'c7
000583 02A8 23               		inc	hl
000584 02A9 36B7             		ld	(hl), h'b7
000585 02AB 21FA0B           		ld	hl, MENL
000586 02AE C31E02           		jp	ROTSA
000587 02B1                  
000588 02B1                  ;****************************************
000589 02B1                  ;	altera registrador l
000590 02B1                  ;****************************************
000591 02B1                  
000592 02B1 21FA0B           ALTL:	ld	hl, MENL
000593 02B4 78               		ld	a, b
000594 02B5 ED6F             		rld
000595 02B7 C31E02           		jp	ROTSA
000596 02BA                  
000597 02BA                  ;****************************************
000598 02BA                  ;	registrador f
000599 02BA                  ;****************************************
000600 02BA                  
000601 02BA CDEA01           REGF:	call	INIT
000602 02BD 368E             		ld	(hl), h'8e
000603 02BF 23               		inc	hl
000604 02C0 36B7             		ld	(hl), h'b7
000605 02C2 21F80B           		ld	hl, MENF
000606 02C5 C31E02           		jp	ROTSA
000607 02C8                  
000608 02C8                  ;****************************************
000609 02C8                  ;	altera registrador f
000610 02C8                  ;****************************************
000611 02C8                  
000612 02C8 21F80B           ALTF:	ld	hl, MENF
000613 02CB 78               		ld	a, b
000614 02CC ED6F             		rld
000615 02CE C31E02           		jp	ROTSA
000616 02D1                  
000617 02D1                  ;****************************************
000618 02D1                  ;	registrador i
000619 02D1                  ;****************************************
000620 02D1                  
000621 02D1 ED57             REGI:	ld	a, i
000622 02D3 21F70B           		ld	hl, MENI
000623 02D6 77               		ld	(hl), a
000624 02D7 CDEA01           		call	INIT
000625 02DA 36F9             		ld	(hl), h'f9
000626 02DC 23               		inc	hl
000627 02DD 36B7             		ld	(hl), h'b7
000628 02DF 21F70B           		ld	hl, MENI
000629 02E2 C31E02           		jp	ROTSA
000630 02E5                  
000631 02E5                  ;****************************************
000632 02E5                  ;	altera registrador i
000633 02E5                  ;****************************************
000634 02E5                  
000635 02E5 21F70B           ALTI:	ld	hl, MENI
000636 02E8 78               		ld	a, b
000637 02E9 ED6F             		rld
000638 02EB 7E               		ld	a, (hl)
000639 02EC ED47             		ld	i, a
000640 02EE C31E02           		jp	ROTSA
000641 02F1                  
000642 02F1                  ;****************************************
000643 02F1                  ;   rotina para o vetor de interrupção
000644 02F1                  ;****************************************
000645 02F1                  
000646 02F1 01F20B           RIV:	ld	bc, ROTNMI
000647 02F4 3EC3             		ld	a, h'c3	; h'c3 = "jp"
000648 02F6 02               		ld	(bc), a
000649 02F7 03               		inc	bc
000650 02F8 21EE0B           		ld	hl, PBE
000651 02FB 7E               		ld	a, (hl)
000652 02FC 02               		ld	(bc), a
000653 02FD 03               		inc	bc
000654 02FE 23               		inc	hl
000655 02FF 7E               		ld	a, (hl)
000656 0300 02               		ld	(bc), a
000657 0301 C31700           		jp	INICIO
000658 0304                  
000659 0304                  ;****************************************
000660 0304                  ;   tabela de seleção de registradores
000661 0304                  ;****************************************
000662 0304                  
000663 0304 0210             TABREG:	.dw	REGA
000664 0306 0230             		.dw	REGB
000665 0308 0247             		.dw	REGC
000666 030A 025E             		.dw	REGD
000667 030C 0275             		.dw	REGE
000668 030E 028C             		.dw	REGH
000669 0310 02A3             		.dw	REGL
000670 0312 02BA             		.dw	REGF
000671 0314 02D1             		.dw	REGI
000672 0316 0002             		.dw	h'+2
000673 0318 C3E201           		jp	ROTER
000674 031B                  
000675 031B                  ;****************************************
000676 031B                  ;  tabela de alteração de registradores
000677 031B                  ;****************************************
000678 031B                  
000679 031B 0227             TABALT:	.dw	ALTA
000680 031D 023E             		.dw	ALTB
000681 031F 0255             TABCOM:	.dw	ALTC
000682 0321 026C             		.dw	ALTD
000683 0323 0283             		.dw	ALTE
000684 0325 029A             		.dw	ALTH
000685 0327 02B1             		.dw	ALTL
000686 0329 02C8             		.dw	ALTF
000687 032B 02E5             		.dw	ALTI
000688 032D 00               		.db	h'00
000689 032E 00               		.db	h'00
000690 032F 00               		.db	h'00
000691 0330                  
000692 0330                  ;****************************************
000693 0330                  ;   tabela de seleção de comandos
000694 0330                  ;****************************************
000695 0330                  
000696 0330 00               		.db	h'00; ROTPER (MSB)
000697 0331 01               		.db	h'01; ROTLT (MSB)
000698 0332 01               		.db	h'01; ROTUL (MSB)
000699 0333 01               		.db	h'01; ROTPR (MSB)
000700 0334 01               		.db	h'01; ROTRD (MSB)
000701 0335 01               		.db	h'01; ROTER (MSB)
000702 0336 02               		.db	h'02; RIV (MSB)
000703 0337 01               		.db	h'01; ROTCP (MSB)
000704 0338 01               		.db	h'01; ROTCD (MSB)
000705 0339 00               		.db	h'00; INICIO (MSB)
000706 033A F5               		.db	h'f5; ROTPER (LSB)
000707 033B 1E               		.db	h'1e; ROTLT (LSB)
000708 033C AF               		.db	h'af; ROTUL (LSB)
000709 033D 9F               		.db	h'9f; ROTPR (LSB)
000710 033E C8               		.db	h'c8; ROTRD (LSB)
000711 033F E2               		.db	h'e2; ROTER (LSB)
000712 0340 F1               		.db	h'f1; RIV (LSB)
000713 0341 0F               		.db	h'0f; ROTCP (LSB)
000714 0342 2F               		.db	h'2f; ROTCD (LSB)
000715 0343 17               		.db	h'17; INICIO (LSB)
000716 0344                  
AJCOL   =00BD  
AJTEC   =00D8  
ALTA    =0227  
ALTB    =023E  
ALTC    =0255  
ALTCOM  =00F0  
ALTD    =026C  
ALTE    =0283  
ALTF    =02C8  
ALTH    =029A  
ALTI    =02E5  
ALTL    =02B1  
ALTREG  =0205  
ATRASO  =0001  
ATUAL   =0140  
BUFDISP =0BE7  
BYTES   =0BEB  
DECOD   =0152  
DISPLY  =016E  
ENDISP  =0BED  
FLAG    =0BE6  
FORMAT  =0186  
INICIO  =0017  
INIT    =01EA  
INTD    =018F  
LOOP1   =00B3  
MENA    =0BF9  
MENB    =0BFF  
MENC    =0BFE  
MENCON  =0BE5  
MEND    =0BFD  
MENE    =0BFC  
MENF    =0BF8  
MENH    =0BFB  
MENI    =0BF7  
MENL    =0BFA  
MENS    =005C  
NE1     =0023  
NE10    =00DE  
NE11    =00FD  
NE12    =01FE  
NE2     =0032  
NE3     =0077  
NE4     =0083  
NE5     =0052  
NE6     =0055  
NE7     =00A0  
NE8     =00D6  
NE9     =00EB  
NMINT   =0066  
PAE     =0BEF  
PBE     =0BEE  
PDIG    =0003  
PSEG    =0001  
PTEC    =0001  
RAME    =0161  
RECCOM  =0069  
REGA    =0210  
REGB    =0230  
REGC    =0247  
REGD    =025E  
REGE    =0275  
REGF    =02BA  
REGH    =028C  
REGI    =02D1  
REGL    =02A3  
REST    =009C  
RIV     =02F1  
ROT     =0BF0  
ROTCD   =012F  
ROTCP   =010F  
ROTER   =01E2  
ROTLT   =011E  
ROTNMI  =0BF2  
ROTPER  =00F5  
ROTPR   =019F  
ROTRD   =01C8  
ROTSA   =021E  
ROTUL   =01AF  
SELREG  =01F4  
TABALT  =031B  
TABCOM  =031F  
TABREG  =0304  
TEMPO   =00A9  
TOPSP   =0BE4  
VARR    =0090  
