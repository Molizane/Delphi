000001 0000                  ;****************************************
000002 0000                  ;	   PROGRAMA MONITOR NESTOR
000003 0000                  ;	       NOVA ELETRÔNICA
000004 0000                  ;	SAO PAULO S.P. 01/84 MSCS/JRP
000005 0000                  ;****************************************
000006 0000                  
000007 0003                  	.equ	PDIG, 	h'03 ; saída coluna teclado e display
000008 0001                  	.equ	PSEG, 	h'01 ; saída caracter para o display
000009 0001                  	.equ	PTEC, 	h'01 ; entrada linha teclado
000010 0000                  
000011 0001                  	.equ	ATRASO, 	h'0001
000012 0BE4                  	.equ	TOPSP, 	h'0be4
000013 0BE5                  	.equ	MENCON, 	h'0be5
000014 0BE6                  	.equ	FLAG, 	h'0be6
000015 0BE7                  	.equ	BUFDISP, 	h'0be7
000016 0BEB                  	.equ	BYTES, 	h'0beb
000017 0BED                  	.equ	ENDISP, 	h'0bed
000018 0BEE                  	.equ	PBE, 	h'0bee
000019 0BEF                  	.equ	PAE, 	h'0bef
000020 0BF0                  	.equ	ROT, 	h'0bf0
000021 0BF2                  	.equ	ROTNMI, 	h'0bf2
000022 0BF7                  	.equ	MENI, 	h'0bf7
000023 0BF8                  	.equ	MENF, 	h'0bf8
000024 0BF9                  	.equ	MENA, 	h'0bf9
000025 0BFA                  	.equ	MENL, 	h'0bfa
000026 0BFB                  	.equ	MENH, 	h'0bfb
000027 0BFC                  	.equ	MENE, 	h'0bfc
000028 0BFD                  	.equ	MEND, 	h'0bfd
000029 0BFE                  	.equ	MENC, 	h'0bfe
000030 0BFF                  	.equ	MENB, 	h'0bff
000031 0000                  
000032 0000                  		.org	h'0000
000033 0000 31000C           		ld	sp, h'0c00
000034 0003 C5               		push	bc
000035 0004 D5               		push	de
000036 0005 E5               		push	hl
000037 0006 F5               		push	af
000038 0007 21E60B           		ld	hl, FLAG
000039 000A 3619             		ld	(hl), h'19
000040 000C 215C00           		ld	hl, MENS
000041 000F 11E70B           		ld	de, BUFDISP
000042 0012 010600           		ld	bc, h'0006
000043 0015 EDB0             		ldir
000044 0017 31E40B           INICIO:	ld	sp, TOPSP
000045 001A 21E70B           		ld	hl, BUFDISP
000046 001D 0600             		ld	b, h'00
000047 001F 1E06             		ld	e, h'06
000048 0021 3E01             		ld	a, h'01
000049 0023 CD9000           NE1:	call	VARR
000050 0026 79               		ld	a, c
000051 0027 87               		add	a, a
000052 0028 1D               		dec	e
000053 0029 C22300           		jp	nz, NE1
000054 002C 78               		ld	a, b
000055 002D FE00             		cp	h'00
000056 002F CA1700           		jp	z, INICIO
000057 0032 21E70B           NE2:	ld	hl, BUFDISP
000058 0035 CD9C00           		call	REST
000059 0038 7A               		ld	a, d
000060 0039 D303             		out	(PDIG), a
000061 003B DB01             		in	a, (PTEC)
000062 003D FE00             		cp	h'00
000063 003F C23200           		jp	nz, NE2
000064 0042 CDBD00           		call	AJCOL
000065 0045 CDD800           		call	AJTEC
000066 0048 FE13             		cp	h'13
000067 004A CA7700           		jp	z, NE3
000068 004D FE10             		cp	h'10
000069 004F DA8300           		jp	c, NE4
000070 0052 CDF000           NE5:	call	ALTCOM
000071 0055 21E60B           NE6:	ld	hl, FLAG
000072 0058 7E               		ld	a, (hl)
000073 0059 C36900           		jp	RECCOM
000074 005C                  
000075 005C                  ;****************************************
000076 005C                  ;  MENSAGEM INICIAL
000077 005C                  ;****************************************
000078 005C                  
000079 005C C8               MENS:	.db	h'c8; N
000080 005D 86               		.db	h'86; E
000081 005E 92               		.db	h'92; S
000082 005F 87               		.db	h'87; T
000083 0060 C0               		.db	h'c0; O
000084 0061 CE               		.db	h'ce; R
000085 0062 00               		.db	h'00
000086 0063 00               		.db	h'00
000087 0064 00               		.db	h'00
000088 0065 00               		.db	h'00
000089 0066                  
000090 0066                  ;****************************************
000091 0066                  ;  ponto de entrada de interrupção nmi
000092 0066                  ;****************************************
000093 0066                  
000094 0066 C3F20B           NMINT:	jp	ROTNMI	; antes estava "RIV"
000095 0069                  ;
000096 0069 212003           RECCOM:	ld	hl, TABCOM+1
000097 006C 85               		add	a, l
000098 006D 6F               		ld	l, a
000099 006E 7E               		ld	a, (hl)
000100 006F 4F               		ld	c, a
000101 0070 3E0A             		ld	a, h'0a
000102 0072 85               		add	a, l
000103 0073 6F               		ld	l, a
000104 0074 6E               		ld	l, (hl)
000105 0075 61               		ld	h, c
000106 0076 E9               		jp	(hl)
000107 0077 21E60B           NE3:	ld	hl, FLAG
000108 007A 7E               		ld	a, (hl)
000109 007B FE15             		cp	h'15
000110 007D CAF401           		jp	z, SELREG
000111 0080 C35200           		jp	NE5
000112 0083 21E60B           NE4:	ld	hl, FLAG
000113 0086 7E               		ld	a, (hl)
000114 0087 FE15             		cp	h'15
000115 0089 CA0502           		jp	z, ALTREG
000116 008C 00               		nop
000117 008D C35500           		jp	NE6
000118 0090                  
000119 0090                  ;****************************************
000120 0090                  ;	rotina de varredura
000121 0090                  ;****************************************
000122 0090                  
000123 0090 4F               VARR:	ld	c, a
000124 0091 CDA900           		call	TEMPO
000125 0094 DB01             		in	a, (PTEC)
000126 0096 FE00             		cp	h'00
000127 0098 C8               		ret	z
000128 0099 47               		ld	b, a
000129 009A 51               		ld	d, c
000130 009B C9               		ret
000131 009C                  
000132 009C                  ;****************************************
000133 009C                  ;	rotina de restauração
000134 009C                  ;****************************************
000135 009C                  
000136 009C 0E06             REST:	ld	c, h'06
000137 009E 3E01             		ld	a, h'01
000138 00A0 CDA900           NE7:	call	TEMPO
000139 00A3 87               		add	a, a
000140 00A4 0D               		dec	c
000141 00A5 C8               		ret	z
000142 00A6 C3A000           		jp	NE7
000143 00A9                  
000144 00A9                  ;****************************************
000145 00A9                  ;	rotina de tempo
000146 00A9                  ;****************************************
000147 00A9                  
000148 00A9 F5               TEMPO:	push	af
000149 00AA D303             		out	(PDIG), a
000150 00AC 7E               		ld	a, (hl)
000151 00AD D301             		out	(PSEG), a
000152 00AF D9               		exx
000153 00B0 110100           		ld	de, ATRASO
000154 00B3 1B               LOOP1:	dec	de
000155 00B4 7A               		ld	a, d
000156 00B5 B3               		or	e
000157 00B6 C2B300           		jp	nz, LOOP1
000158 00B9 D9               		exx
000159 00BA 23               		inc	hl
000160 00BB F1               		pop	af
000161 00BC C9               		ret
000162 00BD                  
000163 00BD                  ;****************************************
000164 00BD                  ;	rotina de ajuste de coluna
000165 00BD                  ;****************************************
000166 00BD                  
000167 00BD 0E00             AJCOL:	ld	c, h'00
000168 00BF 3E01             		ld	a, h'01
000169 00C1 BA               		cp	d
000170 00C2 CAD600           		jp	z, NE8
000171 00C5 87               		add	a, a
000172 00C6 0E08             		ld	c, h'08
000173 00C8 BA               		cp	d
000174 00C9 CAD600           		jp	z, NE8
000175 00CC 87               		add	a, a
000176 00CD 0E10             		ld	c, h'10
000177 00CF BA               		cp	d
000178 00D0 CAD600           		jp	z, NE8
000179 00D3 C31700           		jp	INICIO
000180 00D6 51               NE8:	ld	d, c
000181 00D7 C9               		ret
000182 00D8                  
000183 00D8                  ;****************************************
000184 00D8                  ;	rotina de ajuste de tecla
000185 00D8                  ;****************************************
000186 00D8                  
000187 00D8 1E08             AJTEC:	ld	e, h'08
000188 00DA 0E00             		ld	c, h'00
000189 00DC 3E01             		ld	a, h'01
000190 00DE B8               NE10:	cp	b
000191 00DF CAEB00           		jp	z, NE9
000192 00E2 0C               		inc	c
000193 00E3 87               		add	a, a
000194 00E4 1D               		dec	e
000195 00E5 C2DE00           		jp	nz, NE10
000196 00E8 C31700           		jp	INICIO
000197 00EB 79               NE9:	ld	a, c
000198 00EC 82               		add	a, d
000199 00ED 47               		ld	b, a
000200 00EE 00               		nop
000201 00EF C9               		ret
000202 00F0                  
000203 00F0                  ;****************************************
000204 00F0                  ;	rotina de alterar comando
000205 00F0                  ;****************************************
000206 00F0                  
000207 00F0 21E60B           ALTCOM:	ld	hl, FLAG
000208 00F3 70               		ld	(hl), b
000209 00F4 C9               		ret
000210 00F5                  
000211 00F5                  ;****************************************
000212 00F5                  ;	rotina de permissão
000213 00F5                  ;****************************************
000214 00F5                  
000215 00F5 0E06             ROTPER:	ld	c, h'06
000216 00F7 21E60B           		ld	hl, FLAG
000217 00FA 3617             		ld	(hl), h'17
000218 00FC 23               		inc	hl
000219 00FD 36FF             NE11:	ld	(hl), h'ff
000220 00FF 23               		inc	hl
000221 0100 0D               		dec	c
000222 0101 C2FD00           		jp	nz, NE11
000223 0104 3600             		ld	(hl), h'00
000224 0106 23               		inc	hl
000225 0107 3600             		ld	(hl), h'00
000226 0109 23               		inc	hl
000227 010A 3600             		ld	(hl), h'00
000228 010C C31700           		jp	INICIO
000229 010F                  
000230 010F                  ;****************************************
000231 010F                  ;	rotina de campo de endereços
000232 010F                  ;****************************************
000233 010F                  
000234 010F 21EE0B           ROTCP:	ld	hl, PBE
000235 0112 78               		ld	a, b
000236 0113 ED6F             		rld
000237 0115 23               		inc	hl
000238 0116 ED6F             		rld
000239 0118 CD5201           		call	DECOD
000240 011B C31700           		jp	INICIO
000241 011E                  
000242 011E                  ;****************************************
000243 011E                  ;	rotina de leitura
000244 011E                  ;****************************************
000245 011E                  
000246 011E CD4001           ROTLT:	call	ATUAL
000247 0121 21E60B           		ld	hl, FLAG
000248 0124 3618             		ld	(hl), h'18
000249 0126 21EF0B           		ld	hl, PAE
000250 0129 CD5201           		call	DECOD
000251 012C C31700           		jp	INICIO
000252 012F                  
000253 012F                  ;****************************************
000254 012F                  ;	rotina de campo de dados
000255 012F                  ;****************************************
000256 012F                  
000257 012F CD4001           ROTCD:	call	ATUAL
000258 0132 78               		ld	a, b
000259 0133 ED6F             		rld
000260 0135 7E               		ld	a, (hl)
000261 0136 12               		ld	(de), a
000262 0137 21EF0B           		ld	hl, PAE
000263 013A CD5201           		call	DECOD
000264 013D C31700           		jp	INICIO
000265 0140                  
000266 0140                  ;****************************************
000267 0140                  ;	rotina de atualização
000268 0140                  ;****************************************
000269 0140                  
000270 0140 21EE0B           ATUAL:	ld	hl, PBE
000271 0143 5E               		ld	e, (hl)
000272 0144 23               		inc	hl
000273 0145 56               		ld	d, (hl)
000274 0146 1A               		ld	a, (de)
000275 0147 2B               		dec	hl
000276 0148 2B               		dec	hl
000277 0149 77               		ld	(hl), a
000278 014A E5               		push	hl
000279 014B 21E60B           		ld	hl, FLAG
000280 014E 3618             		ld	(hl), h'18
000281 0150 E1               		pop	hl
000282 0151 C9               		ret
000283 0152                  
000284 0152                  ;****************************************
000285 0152                  ;	rotina de DECODificação
000286 0152                  ;****************************************
000287 0152                  
000288 0152 01E70B           DECOD:	ld	bc, BUFDISP
000289 0155 CD6E01           		call	DISPLY
000290 0158 2B               		dec	hl
000291 0159 CD6E01           		call	DISPLY
000292 015C 2B               		dec	hl
000293 015D CD6E01           		call	DISPLY
000294 0160 C9               		ret
000295 0161                  
000296 0161                  ;****************************************
000297 0161                  ;  rotina de ajuste memória de endereço
000298 0161                  ;****************************************
000299 0161                  
000300 0161 21EE0B           RAME:	ld	hl, PBE
000301 0164 73               		ld	(hl), e
000302 0165 23               		inc	hl
000303 0166 72               		ld	(hl), d
000304 0167 2B               		dec	hl
000305 0168 2B               		dec	hl
000306 0169 1A               		ld	a, (de)
000307 016A 77               		ld	(hl), a
000308 016B C9               		ret
000309 016C FFFF             		.dw	h'ffff
000310 016E                  
000311 016E                  ;****************************************
000312 016E                  ;	rotina de DISPLY
000313 016E                  ;****************************************
000314 016E                  
000315 016E 7E               DISPLY:	ld	a, (hl)
000316 016F E5               		push	hl
000317 0170 21F00B           		ld	hl, ROT
000318 0173 77               		ld	(hl), a
000319 0174 AF               		xor	a
000320 0175 ED6F             		rld
000321 0177 CD8601           		call	FORMAT
000322 017A 02               		ld	(bc), a
000323 017B 03               		inc	bc
000324 017C AF               		xor	a
000325 017D ED6F             		rld
000326 017F CD8601           		call	FORMAT
000327 0182 02               		ld	(bc), a
000328 0183 03               		inc	bc
000329 0184 E1               		pop	hl
000330 0185 C9               		ret
000331 0186                  
000332 0186                  ;****************************************
000333 0186                  ;	rotina de formatação
000334 0186                  ;****************************************
000335 0186                  
000336 0186 D5               FORMAT:	push	de
000337 0187 118F01           		ld	de, INTD
000338 018A 83               		add	a, e
000339 018B 5F               		ld	e, a
000340 018C 1A               		ld	a, (de)
000341 018D D1               		pop	de
000342 018E C9               		ret
000343 018F                  
000344 018F                  ;****************************************
000345 018F                  ;	tabela de formatos alfa (números)
000346 018F                  ;****************************************
000347 018F                  
000348 018F C0               INTD:	.db	h'c0
000349 0190 F9               		.db	h'f9
000350 0191 A4               		.db	h'a4
000351 0192 B0               		.db	h'b0
000352 0193 99               		.db	h'99
000353 0194 92               		.db	h'92
000354 0195 82               		.db	h'82
000355 0196 F8               		.db	h'f8
000356 0197 80               		.db	h'80
000357 0198 90               		.db	h'90
000358 0199 88               		.db	h'88
000359 019A 83               		.db	h'83
000360 019B C6               		.db	h'c6
000361 019C A1               		.db	h'a1
000362 019D 86               		.db	h'86
000363 019E 8E               		.db	h'8e
000364 019F                  
000365 019F                  ;****************************************
000366 019F                  ;	rotina de próximo
000367 019F                  ;****************************************
000368 019F                  
000369 019F CD4001           ROTPR:	call	ATUAL
000370 01A2 13               		inc	de
000371 01A3 CD6101           		call	RAME
000372 01A6 21EF0B           		ld	hl, PAE
000373 01A9 CD5201           		call	DECOD
000374 01AC C31700           		jp	INICIO
000375 01AF                  
000376 01AF                  ;****************************************
000377 01AF                  ;	rotina de último
000378 01AF                  ;****************************************
000379 01AF                  
000380 01AF CD4001           ROTUL:	call	ATUAL
000381 01B2 1B               		dec	de
000382 01B3 CD6101           		call	RAME
000383 01B6 21EF0B           		ld	hl, PAE
000384 01B9 CD5201           		call	DECOD
000385 01BC C31700           		jp	INICIO
000386 01BF                  
000387 01BF                  ;****************************************
000388 01BF                  ;	rotina de rodar
000389 01BF                  ;****************************************
000390 01BF                  
000391 01C8                  		.org	h'01c8
000392 01C8 3EFF             ROTRD:	ld	a, h'ff
000393 01CA D303             		out	(PDIG), a
000394 01CC 3E7F             		ld	a, h'7f
000395 01CE D301             		out	(PSEG), a
000396 01D0 21ED0B           		ld	hl, ENDISP; antes estava "MEND"
000397 01D3 36C3             		ld	(hl), h'c3; h'c3 = "jp"
000398 01D5 31F80B           		ld	sp, MENF	; antes estava "MENI"
000399 01D8 F5               		push	af
000400 01D9 E5               		push	hl
000401 01DA D5               		push	de
000402 01DB C5               		push	bc
000403 01DC 31E40B           		ld	sp, TOPSP
000404 01DF C3ED0B           		jp	ENDISP
000405 01E2                  
000406 01E2                  ;****************************************
000407 01E2                  ;    rotina de exame de registradores
000408 01E2                  ;****************************************
000409 01E2                  
000410 01E2 21E50B           ROTER:	ld	hl, MENCON
000411 01E5 36FE             		ld	(hl), h'fe
000412 01E7 C3F401           		jp	SELREG
000413 01EA                  
000414 01EA                  ;****************************************
000415 01EA                  ;	rotina de inicialização
000416 01EA                  ;****************************************
000417 01EA                  
000418 01EA 21E70B           INIT:	ld	hl, BUFDISP
000419 01ED 36FF             		ld	(hl), h'ff
000420 01EF 23               		inc	hl
000421 01F0 36FF             		ld	(hl), h'ff
000422 01F2 23               		inc	hl
000423 01F3 C9               		ret
000424 01F4                  
000425 01F4                  ;****************************************
000426 01F4                  ;   rotina de seleção de registradores
000427 01F4                  ;****************************************
000428 01F4                  
000429 01F4 110403           SELREG:	ld	de, TABREG
000430 01F7 21E50B           		ld	hl, MENCON
000431 01FA 34               		inc	(hl)
000432 01FB 34               		inc	(hl)
000433 01FC 7B               		ld	a, e
000434 01FD 86               		add	a, (hl)
000435 01FE 5F               NE12:	ld	e, a
000436 01FF 1A               		ld	a, (de)
000437 0200 6F               		ld	l, a
000438 0201 13               		inc	de
000439 0202 1A               		ld	a, (de)
000440 0203 67               		ld	h, a
000441 0204 E9               		jp	(hl)
000442 0205                  
000443 0205                  ;****************************************
000444 0205                  ;  rotina de alteração de registradores
000445 0205                  ;****************************************
000446 0205                  
000447 0205 21E50B           ALTREG:	ld	hl, MENCON
000448 0208 111B03           		ld	de, TABALT
000449 020B 7B               		ld	a, e
000450 020C 86               		add	a, (hl)
000451 020D C3FE01           		jp	NE12
000452 0210                  
000453 0210                  ;****************************************
000454 0210                  ;	registrador a
000455 0210                  ;****************************************
000456 0210                  
000457 0210 CDEA01           REGA:	call	INIT
000458 0213 3688             		ld	(hl), h'88
000459 0215 23               		inc	hl
000460 0216 36B7             		ld	(hl), h'b7
000461 0218 21F90B           		ld	hl, MENA
000462 021B C31E02           		jp	ROTSA
000463 021E                  
000464 021E                  ;****************************************
000465 021E                  ;	rotina de saída
000466 021E                  ;****************************************
000467 021E                  
000468 021E 01EB0B           ROTSA:	ld	bc, BYTES
000469 0221 CD6E01           		call	DISPLY
000470 0224 C31700           		jp	INICIO
000471 0227                  
000472 0227                  ;****************************************
000473 0227                  ;	altera registrador a
000474 0227                  ;****************************************
000475 0227                  
000476 0227 21F90B           ALTA:	ld	hl, MENA
000477 022A 78               		ld	a, b
000478 022B ED6F             		rld
000479 022D C31E02           		jp	ROTSA
000480 0230                  
000481 0230                  ;****************************************
000482 0230                  ;	registrador b
000483 0230                  ;****************************************
000484 0230                  
000485 0230 CDEA01           REGB:	call	INIT
000486 0233 3683             		ld	(hl), h'83
000487 0235 23               		inc	hl
000488 0236 36B7             		ld	(hl), h'b7
000489 0238 21FF0B           		ld	hl, MENB
000490 023B C31E02           		jp	ROTSA
000491 023E                  
000492 023E                  ;****************************************
000493 023E                  ;	altera registrador b
000494 023E                  ;****************************************
000495 023E                  
000496 023E 21FF0B           ALTB:	ld	hl, MENB
000497 0241 78               		ld	a, b
000498 0242 ED6F             		rld
000499 0244 C31E02           		jp	ROTSA
000500 0247                  
000501 0247                  ;****************************************
000502 0247                  ;	registrador c
000503 0247                  ;****************************************
000504 0247                  
000505 0247 CDEA01           REGC:	call	INIT
000506 024A 36C6             		ld	(hl), h'c6
000507 024C 23               		inc	hl
000508 024D 36B7             		ld	(hl), h'b7
000509 024F 21FE0B           		ld	hl, MENC
000510 0252 C31E02           		jp	ROTSA
000511 0255                  
000512 0255                  ;****************************************
000513 0255                  ;	altera registrador c
000514 0255                  ;****************************************
000515 0255                  
000516 0255 21FE0B           ALTC:	ld	hl, MENC
000517 0258 78               		ld	a, b
000518 0259 ED6F             		rld
000519 025B C31E02           		jp	ROTSA
000520 025E                  
000521 025E                  ;****************************************
000522 025E                  ;	registrador d
000523 025E                  ;****************************************
000524 025E                  
000525 025E CDEA01           REGD:	call	INIT
000526 0261 36A1             		ld	(hl), h'a1
000527 0263 23               		inc	hl
000528 0264 36B7             		ld	(hl), h'b7
000529 0266 21FD0B           		ld	hl, MEND
000530 0269 C31E02           		jp	ROTSA
000531 026C                  
000532 026C                  ;****************************************
000533 026C                  ;	altera registrador d
000534 026C                  ;****************************************
000535 026C                  
000536 026C 21FD0B           ALTD:	ld	hl, MEND
000537 026F 78               		ld	a, b
000538 0270 ED6F             		rld
000539 0272 C31E02           		jp	ROTSA
000540 0275                  
000541 0275                  ;****************************************
000542 0275                  ;	registrador e
000543 0275                  ;****************************************
000544 0275                  
000545 0275 CDEA01           REGE:	call	INIT
000546 0278 3686             		ld	(hl), h'86
000547 027A 23               		inc	hl
000548 027B 36B7             		ld	(hl), h'b7
000549 027D 21FC0B           		ld	hl, MENE
000550 0280 C31E02           		jp	ROTSA
000551 0283                  
000552 0283                  ;****************************************
000553 0283                  ;	altera registrador e
000554 0283                  ;****************************************
000555 0283                  
000556 0283 21FC0B           ALTE:	ld	hl, MENE
000557 0286 78               		ld	a, b
000558 0287 ED6F             		rld
000559 0289 C31E02           		jp	ROTSA
000560 028C                  
000561 028C                  ;****************************************
000562 028C                  ;	registrador h
000563 028C                  ;****************************************
000564 028C                  
000565 028C CDEA01           REGH:	call	INIT
000566 028F 3689             		ld	(hl), h'89
000567 0291 23               		inc	hl
000568 0292 36B7             		ld	(hl), h'b7
000569 0294 21FB0B           		ld	hl, MENH
000570 0297 C31E02           		jp	ROTSA
000571 029A                  
000572 029A                  ;****************************************
000573 029A                  ;	altera registrador h
000574 029A                  ;****************************************
000575 029A                  
000576 029A 21FB0B           ALTH:	ld	hl, MENH
000577 029D 78               		ld	a, b
000578 029E ED6F             		rld
000579 02A0 C31E02           		jp	ROTSA
000580 02A3                  
000581 02A3                  ;****************************************
000582 02A3                  ;	registrador l
000583 02A3                  ;****************************************
000584 02A3                  
000585 02A3 CDEA01           REGL:	call	INIT
000586 02A6 36C7             		ld	(hl), h'c7
000587 02A8 23               		inc	hl
000588 02A9 36B7             		ld	(hl), h'b7
000589 02AB 21FA0B           		ld	hl, MENL
000590 02AE C31E02           		jp	ROTSA
000591 02B1                  
000592 02B1                  ;****************************************
000593 02B1                  ;	altera registrador l
000594 02B1                  ;****************************************
000595 02B1                  
000596 02B1 21FA0B           ALTL:	ld	hl, MENL
000597 02B4 78               		ld	a, b
000598 02B5 ED6F             		rld
000599 02B7 C31E02           		jp	ROTSA
000600 02BA                  
000601 02BA                  ;****************************************
000602 02BA                  ;	registrador f
000603 02BA                  ;****************************************
000604 02BA                  
000605 02BA CDEA01           REGF:	call	INIT
000606 02BD 368E             		ld	(hl), h'8e
000607 02BF 23               		inc	hl
000608 02C0 36B7             		ld	(hl), h'b7
000609 02C2 21F80B           		ld	hl, MENF
000610 02C5 C31E02           		jp	ROTSA
000611 02C8                  
000612 02C8                  ;****************************************
000613 02C8                  ;	altera registrador f
000614 02C8                  ;****************************************
000615 02C8                  
000616 02C8 21F80B           ALTF:	ld	hl, MENF
000617 02CB 78               		ld	a, b
000618 02CC ED6F             		rld
000619 02CE C31E02           		jp	ROTSA
000620 02D1                  
000621 02D1                  ;****************************************
000622 02D1                  ;	registrador i
000623 02D1                  ;****************************************
000624 02D1                  
000625 02D1 ED57             REGI:	ld	a, i
000626 02D3 21F70B           		ld	hl, MENI
000627 02D6 77               		ld	(hl), a
000628 02D7 CDEA01           		call	INIT
000629 02DA 36F9             		ld	(hl), h'f9
000630 02DC 23               		inc	hl
000631 02DD 36B7             		ld	(hl), h'b7
000632 02DF 21F70B           		ld	hl, MENI
000633 02E2 C31E02           		jp	ROTSA
000634 02E5                  
000635 02E5                  ;****************************************
000636 02E5                  ;	altera registrador i
000637 02E5                  ;****************************************
000638 02E5                  
000639 02E5 21F70B           ALTI:	ld	hl, MENI
000640 02E8 78               		ld	a, b
000641 02E9 ED6F             		rld
000642 02EB 7E               		ld	a, (hl)
000643 02EC ED47             		ld	i, a
000644 02EE C31E02           		jp	ROTSA
000645 02F1                  
000646 02F1                  ;****************************************
000647 02F1                  ;   rotina para o vetor de interrupção
000648 02F1                  ;****************************************
000649 02F1                  
000650 02F1 01F20B           RIV:	ld	bc, ROTNMI
000651 02F4 3EC3             		ld	a, h'c3	; h'c3 = "jp"
000652 02F6 02               		ld	(bc), a
000653 02F7 03               		inc	bc
000654 02F8 21EE0B           		ld	hl, PBE
000655 02FB 7E               		ld	a, (hl)
000656 02FC 02               		ld	(bc), a
000657 02FD 03               		inc	bc
000658 02FE 23               		inc	hl
000659 02FF 7E               		ld	a, (hl)
000660 0300 02               		ld	(bc), a
000661 0301 C31700           		jp	INICIO
000662 0304                  
000663 0304                  ;****************************************
000664 0304                  ;   tabela de seleção de registradores
000665 0304                  ;****************************************
000666 0304                  
000667 0304 0210             TABREG:	.dw	REGA
000668 0306 0230             		.dw	REGB
000669 0308 0247             		.dw	REGC
000670 030A 025E             		.dw	REGD
000671 030C 0275             		.dw	REGE
000672 030E 028C             		.dw	REGH
000673 0310 02A3             		.dw	REGL
000674 0312 02BA             		.dw	REGF
000675 0314 02D1             		.dw	REGI
000676 0316 0002             		.dw	h'+2
000677 0318 C3E201           		jp	ROTER
000678 031B                  
000679 031B                  ;****************************************
000680 031B                  ;  tabela de alteração de registradores
000681 031B                  ;****************************************
000682 031B                  
000683 031B 0227             TABALT:	.dw	ALTA
000684 031D 023E             		.dw	ALTB
000685 031F 0255             TABCOM:	.dw	ALTC
000686 0321 026C             		.dw	ALTD
000687 0323 0283             		.dw	ALTE
000688 0325 029A             		.dw	ALTH
000689 0327 02B1             		.dw	ALTL
000690 0329 02C8             		.dw	ALTF
000691 032B 02E5             		.dw	ALTI
000692 032D 00               		.db	h'00
000693 032E 00               		.db	h'00
000694 032F 00               		.db	h'00
000695 0330                  
000696 0330                  ;****************************************
000697 0330                  ;   tabela de seleção de comandos
000698 0330                  ;****************************************
000699 0330                  
000700 0330 00               		.db	h'00; ROTPER (MSB)
000701 0331 01               		.db	h'01; ROTLT (MSB)
000702 0332 01               		.db	h'01; ROTUL (MSB)
000703 0333 01               		.db	h'01; ROTPR (MSB)
000704 0334 01               		.db	h'01; ROTRD (MSB)
000705 0335 01               		.db	h'01; ROTER (MSB)
000706 0336 02               		.db	h'02; RIV (MSB)
000707 03 37 01               		.db	h'01; ROTCP (MSB)
000708 0338 01               		.db	h'01; ROTCD (MSB)
000709 0339 00               		.db	h'00; INICIO (MSB)
000710 033A F5               		.db	h'f5; ROTPER (LSB)
000711 033B 1E               		.db	h'1e; ROTLT (LSB)
000712 033C AF               		.db	h'af; ROTUL (LSB)
000713 033D 9F               		.db	h'9f; ROTPR (LSB)
000714 033E C8               		.db	h'c8; ROTRD (LSB)
000715 033F E2               		.db	h'e2; ROTER (LSB)
000716 0340 F1               		.db	h'f1; RIV (LSB)
000717 0341 0F               		.db	h'0f; ROTCP (LSB)
000718 0342 2F               		.db	h'2f; ROTCD (LSB)
000719 0343 17               		.db	h'17; INICIO (LSB)
000720 0344                  
AJCOL   =00BD  
AJTEC   =00D8  
ALTA    =0227  
ALTB    =023E  
ALTC    =0255  
ALTCOM  =00F0  
ALTD    =026C  
ALTE    =0283  
ALTF    =02C8  
ALTH    =029A  
ALTI    =02E5  
ALTL    =02B1  
ALTREG  =0205  
ATRASO  =0001  
ATUAL   =0140  
BUFDISP =0BE7  
BYTES   =0BEB  
DECOD   =0152  
DISPLY  =016E  
ENDISP  =0BED  
FLAG    =0BE6  
FORMAT  =0186  
INICIO  =0017  
INIT    =01EA  
INTD    =018F  
LOOP1   =00B3  
MENA    =0BF9  
MENB    =0BFF  
MENC    =0BFE  
MENCON  =0BE5  
MEND    =0BFD  
MENE    =0BFC  
MENF    =0BF8  
MENH    =0BFB  
MENI    =0BF7  
MENL    =0BFA  
MENS    =005C  
NE1     =0023  
NE10    =00DE  
NE11    =00FD  
NE12    =01FE  
NE2     =0032  
NE3     =0077  
NE4     =0083  
NE5     =0052  
NE6     =0055  
NE7     =00A0  
NE8     =00D6  
NE9     =00EB  
NMINT   =0066  
PAE     =0BEF  
PBE     =0BEE  
PDIG    =0003  
PSEG    =0001  
PTEC    =0001  
RAME    =0161  
RECCOM  =0069  
REGA    =0210  
REGB    =0230  
REGC    =0247  
REGD    =025E  
REGE    =0275  
REGF    =02BA  
REGH    =028C  
REGI    =02D1  
REGL    =02A3  
REST    =009C  
RIV     =02F1  
ROT     =0BF0  
ROTCD   =012F  
ROTCP   =010F  
ROTER   =01E2  
ROTLT   =011E  
ROTNMI  =0BF2  
ROTPER  =00F5  
ROTPR   =019F  
ROTRD   =01C8  
ROTSA   =021E  
ROTUL   =01AF  
SELREG  =01F4  
TABALT  =031B  
TABCOM  =031F  
TABREG  =0304  
TEMPO   =00A9  
TOPSP   =0BE4  
VARR    =0090  
                                                                                                                    h'00
000047 001F 1E06             		ld	e, h'06
000048 0021 3E01             		ld	a, h'01
000049 0023 CD9000           NE1:	c